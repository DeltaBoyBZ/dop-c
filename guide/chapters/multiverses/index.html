<html>
    <head><link rel="stylesheet" href="https://deltaboybz.github.io/dop-c/guide/css/global.css">
<link rel="stylesheet" href="https://deltaboybz.github.io/dop-c/guide/css/chapter.css">
    </head>
    <body>
    <div id="title-div">
        <h1> DOP-C Programming Guide </h1>
        <h2> Multiverses </h2> 
    </div>
    <div id="logo-div">
        <a href="https://deltaboybz.github.io/dop-c">
            <img id="tabi-logo" src="https://deltaboybz.github.io/dop-c/guide/img/logo.png ">
        </a>
    </div>
    <div id="menu-div">
        <hr class="toc"> 
        
        <a class="toc" href="/dop-c/guide/chapters/introduction"><div class="toc"><h3 class="toc">Introduction</h3></div></a></li>
        <hr class="toc">
        
        <a class="toc" href="/dop-c/guide/chapters/getting-started"><div class="toc"><h3 class="toc">Getting Started</h3></div></a></li>
        <hr class="toc">
        
        <a class="toc" href="/dop-c/guide/chapters/constructing"><div class="toc"><h3 class="toc">Constructing Tables</h3></div></a></li>
        <hr class="toc">
        
        <a class="toc" href="/dop-c/guide/chapters/inserting"><div class="toc"><h3 class="toc">Inserting and Removing Rows</h3></div></a></li>
        <hr class="toc">
        
        <a class="toc" href="/dop-c/guide/chapters/finding"><div class="toc"><h3 class="toc">Finding Values</h3></div></a></li>
        <hr class="toc">
        
        <a class="toc" href="/dop-c/guide/chapters/sorting"><div class="toc"><h3 class="toc">Sorting Rows</h3></div></a></li>
        <hr class="toc">
        
        <a class="toc" href="/dop-c/guide/chapters/multiverses"><div class="toc"><h3 class="toc">Multiverses</h3></div></a></li>
        <hr class="toc">
        
    </div>
    <div id="text-div">
    <p>Sometimes we want our table to be editable by more than one process.
Doing this naively however will lead to memory races, which is never good.
DOP-C therefore employs the concept of a <strong>multiverse</strong>.
By this, we mean the creation of many versions of a table that can be separately edited.
These copies can be collapsed later back into the original.</p>
<h2 id="creating-a-multiverse">Creating a Multiverse</h2>
<p>In order to create a multiverse, we need a table prototype.
This is a class which represents the constituents of our table and how they are initialised.
We also need to create an array of these to represent the copies.
To see an example of this, see <a href="/dop-c/guide/chapters/constructing">Constructing Tables</a>.
The pattern used in the example is used in the example below:</p>
<pre><code>Data::Proto copies[10]; 
dopc::AdditiveMultiverse&lt;Data::Proto&gt; multiverse(&amp;Data::main, 10, copies, 0);
</code></pre>
<p>The final argument in the multiverse constructor represents the offset in the <code>Data::Proto</code> class at which to find the <code>dopc::Table</code>.
Once we have created a multiverse, each copy can be passed to separate threads quite safely.
Note that, as of now, we only have <em>additive</em> multiverses.
This means that each thread should not endeavour to remove rows, or sort the tables.</p>
<h2 id="collapsing-the-multiverse">Collapsing the Multiverse</h2>
<p>Once each thread is done with its copy, we can apply all additions to the original table.</p>
<pre><code>multiverse.collapse(); 
</code></pre>
<p>The original table <code>Data::main</code> should now contain all rows added by each thread.</p>

    </div>
    </body>
</html>
